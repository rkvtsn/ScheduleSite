@using System.Text



@functions {
	private static string _root = null;

	static public String GetRoot(string uri)
	{
		if (Request.Url == null) return uri;

		var sb = new StringBuilder();
		if (_root == null)
		{
			// Получаем адрес рута
			// http://host.dom:port/uri
			if (Request.Url.Scheme.Trim() != String.Empty)
			{
				sb.Append(Request.Url.Scheme);
				sb.Append("://");
			}

			if (Request.Url.Host.Trim() != String.Empty)
			{
				sb.Append(Request.Url.Host);
			}

			if (Request.Url.Scheme.Trim() != String.Empty)
			{
				sb.Append(":");
				sb.Append(Request.Url.Port);
			}
		}
		else
		{
			// Если есть рут, то берем его
			sb.Append(_root);
		}

		if (uri != null && uri.Trim() != string.Empty)
			sb.Append(uri);

		return sb.ToString();
	}

	static public String GetRoot()
	{
		return GetRoot(null);
	}
	
}

@helper ValidatorScriptBlock() {
	<link href="@GetRoot("/Content/validation.css")" rel="stylesheet" type="text/css" />
	<script src="@GetRoot("/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
	<script src="@GetRoot("/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
}


@helper AddingLessonScript() {
	
	<div id="element-fields">
	</div>
	
	<style>
		#element-additor {
			margin: 10px 0;
		}
		#element-additor a {
			display: inline-block;
			padding: 3px 9px;
			text-decoration: none;
			font-size: 16px;
			background: #333;
			color: #fff;
			margin: 3px 5px;
		}
			#element-additor a:hover {
				background: #fff;
				color: #333;
			}
			
	</style>
	<p id="element-additor"><a href="javascript: void(0)" id="add_element">Добавить поле</a><a href="javascript: void(0)" id="remove_element">Убрать поле</a></p>
	
<script>
	function updateTimeInputs() {
		for (var i = 0; i < 60; i++) {
			$(".minutes").append('<option value="' + i + '">' + ((i >= 10) ? i : '0' + i) + '</option>');
			if (i < 24)
				$(".hours").append('<option value="' + i + '">' + ((i >= 10) ? i : '0' + i) + '</option>');
		}
	}

	updateTimeInputs();

	var countOfelements = 0;
	$("#add_element").click(function () {
		var html = '<div class="lesson-time" id="element_' + (++countOfelements) + '" > <div class="editor-label"> <label>Время ' + (countOfelements + 1) + '-го звонка:</label> </div> <select class="hours" data-val="true" data-val-number="Значением поля Часы должно быть число." data-val-range="Поле Часы должно иметь значение между 0 и 24." data-val-range-max="24" data-val-range-min="0" data-val-required="Требуется поле Часы." id="Lessons_' + countOfelements + '__Hours" name="Lessons[' + countOfelements + '].Hours"> </select> <span class="field-validation-valid" data-valmsg-for="Lessons[' + countOfelements + '].Hours" data-valmsg-replace="true"></span> : <select class="minutes" data-val-number="Значением поля Минуты должно быть число." data-val-range="Поле Минуты должно иметь значение между 0 и 60." data-val-range-max="60" data-val-range-min="0" data-val-required="Требуется поле Минуты." id="Lessons_' + countOfelements + '__Minutes" name="Lessons[' + countOfelements + '].Minutes"> </select> <span class="field-validation-valid" data-valmsg-for="Lessons[' + countOfelements + '].Minutes" data-valmsg-replace="true"></span> </div>';
		$("#element-fields").append(html);
		updateTimeInputs();
	});
	$("#remove_element").click(function () {
		if (countOfelements > 0)
			$("#element_" + (countOfelements--)).remove();
	});
</script>
}

